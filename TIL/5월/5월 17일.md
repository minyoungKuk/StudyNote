# [TIL] - ì±Œë¦°ì§€ë°˜ ê³¼ì œ, ë”¥ë‹¤ì´ë¸Œ ìŠ¤í„°ë””

## âœ… ê³µë¶€í•œ ë‚´ìš©

### âœ”ï¸ [ë”¥ë‹¤ì´ë¸Œ ìŠ¤í„°ë””](https://github.com/hyeonseok98/js-deep-dive-study/blob/main/%5B12%EC%9E%A5%5D%20%ED%95%A8%EC%88%98/%EA%B5%AD%EB%AF%BC%EC%98%81.md)

### âœ”ï¸ useEffect : ì‚¬ì´ë“œ ì´í™íŠ¸ë¥¼ ìœ„í•´ ì‚¬ìš©í•˜ëŠ” í›…

> ì‚¬ì´ë“œ ì´í™íŠ¸ë€? <br>
> ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ì™¸ì— ë°œìƒí•˜ëŠ” ì‘ì—… <br>
> ì˜ˆë¥¼ë“¤ë©´, ë°ì´í„° fetching, DOM ì¡°ì‘, êµ¬ë… ì„¤ì • ë° í•´ì œ ë“±ì´ ì‚¬ì´ë“œ ì´í™íŠ¸ì— í•´ë‹¹

#### ğŸ«§ 'useEffect'ì˜ ê¸°ë³¸ êµ¬ì¡°

**ë‘ ê°œì˜ ì¸ìˆ˜ë¥¼ ë°›ìŠµë‹ˆë‹¤.**

1. ì‹¤í–‰í•  í•¨ìˆ˜ (effect)
2. ì˜ì¡´ì„± ë°°ì—´ (dependence)

```jsx
useEffect(() => {
  // ì‹¤í–‰í•  ì½”ë“œ
  return () => {
    // ì •ë¦¬(cleanup)í•  ì½”ë“œ (ì„ íƒì‚¬í•­)
  }
}, [ì˜ì¡´ì„± ë°°ì—´])
```

#### ğŸ«§ ì–¸ì œ ì‚¬ìš©í•˜ëŠ”ê°€?

- ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ë  ë–„ í•œ ë²ˆ ì‹¤í–‰ : ì˜ì¡´ì„± ë°°ì—´ì„ ë¹ˆ ë°°ì—´'[]'ë¡œ ë‘ë©´ ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ë§ˆìš´íŠ¸ ë  ë•Œë§Œ effeftê°€ ì‹¤í–‰
- íŠ¹ì • ìƒíƒœë‚˜ propì´ ë³‘ê²½ë  ë•Œ ì‹¤í–‰ : ì˜ì¡´ì„± ë°°ì—´ì— íŠ¹ì • ìƒíƒœë‚˜ propsë¥¼ ë„£ìœ¼ë©´, ê·¸ê²ƒë“¤ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ effectê°€ ì‹¤í–‰
- ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ë  ë•Œ ì •ë¦¬ ì‘ì—… ì‹¤í–‰ : effect í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ë˜ê±°ë‚˜, ì˜ì¡´ì„± ë°°ì—´ì˜ ê°’ì´ ë³€ê²½ë  ë•Œ ì‹¤í–‰

#### ğŸ«§ ì‚¬ìš© ì˜ˆì‹œ

1. ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ë§ˆìš´íŠ¸ë  ë•Œ í•œë²ˆ ì‹¤í–‰

```jsx
useEffect(() => {
  console.log("ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ë  ë•Œ ì‹¤í–‰");
}, []);
```

2. íŠ¹ì • ìƒíƒœê°€ ë³€ê²½ë  ë•Œ ì‹¤í–‰

```jsx
const [count, setCount] = useState(0);

useEffect(() => {
  console.log("countê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì‹¤í–‰", count);
}, [count]);
```

3. ì •ë¦¬(cleanup) ì‘ì—…

```jsx
useEffect(() => {
  const timer = setInterval(() => {
    console.log("1ì´ˆë§ˆë‹¤ ì‹¤í–‰");
  }, 1000);

  // ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ë  ë•Œ ì •ë¦¬ ì‘ì—… ì‹¤í–‰
  return () => clearInterval(timer);
}, []);
```

#### ğŸ«§ useEffectë¥¼ ì‚¬ìš©í•œ ì˜ˆì œ

- ì±Œë¦°ì§€ë°˜ ê³¼ì œì— ì ìš©í•œ ì˜ˆì œ!

```jsx
import React, { useEffect, useState } from "react";
import styled, { css, keyframes } from "styled-components";

const jumpAnimation = keyframes`
  0% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-10px);
  }
  100% {
    transform: translateY(0);
  }
`;

const Wrapper = styled.section`
  width: 500px;
  height: 500px;
  margin: 0 auto;
  background-image: url("/src/assets/images/grass.png");
  position: relative;
  outline: none;
`;

const ImgWrapper = styled.div`
  width: 50px;
  height: 50px;
  background-image: url("/src/assets/images/pikachu.png");
  background-size: 50px 50px;
  position: absolute;
  transition: all 0.4s ease;
  top: ${({ $top }) => `${$top}px`};
  left: ${({ $left }) => `${$left}px`};
  ${({ $isFlipped }) => $isFlipped && `transform: scaleX(-1);`}
  ${({ $isJumping }) =>
    $isJumping &&
    css`
      animation: ${jumpAnimation} 0.5s;
    `}
`;

const App = () => {
  const [position, setPosition] = useState([0, 0]);
  const [isFlipped, setIsFlipped] = useState(false);
  const [isJumping, setIsJumping] = useState(false);

  const fieldSize = 500;
  const imgSize = 50;

  useEffect(() => {
    if (isJumping) {
      const timer = setTimeout(() => {
        setIsJumping(false);
      }, 500);
      return () => clearTimeout(timer);
    }
  }, [isJumping]);

  const handleKeyDown = (e) => {
    let [newX, newY] = position;

    switch (e.key) {
      case "ArrowUp":
        newY = Math.max(newY - imgSize, 0);
        break;
      case "ArrowDown":
        newY = Math.min(newY + imgSize, fieldSize - imgSize);
        break;
      case "ArrowLeft":
        newX = Math.max(newX - imgSize, 0);
        setIsFlipped(true);
        break;
      case "ArrowRight":
        newX = Math.min(newX + imgSize, fieldSize - imgSize);
        setIsFlipped(false);
        break;
      case " ":
        setIsJumping(true);
        break;
      default:
        break;
    }

    setPosition([newX, newY]);
  };

  return (
    <Wrapper tabIndex="0" onKeyDown={handleKeyDown}>
      <ImgWrapper
        $left={position[0]}
        $top={position[1]}
        $isFlipped={isFlipped}
        $isJumping={isJumping}
      />
    </Wrapper>
  );
};

export default App;

// 1. ìƒíƒœê´€ë¦¬ : "position", "isFlipped", "isJumping" ìƒíƒœë¥¼ ì •ì˜
// 2. ì´í™íŠ¸ : "isJumping" ìƒíƒœê°€ "true"ë¡œ ì„¤ì •ë˜ë©´, 0.5ì´ˆ í›„ì— falseë¡œ ë³€ê²½. ì´ ê³¼ì •ì—ì„œ setTimeoutì„ ì‚¬ìš©í•˜ê³ , ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ë˜ê±°ë‚˜ "isJumping" ìƒíƒœê°€ ë³€ê²½ë  ë•Œ íƒ€ì´ë¨¸ë¥¼ ì •ë¦¬
// 3. í‚¤ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ : ë°©í–¥í‚¤ì™€ ìŠ¤í˜ì´ìŠ¤ë°” ì…ë ¥ì— ë”°ë¼ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸
```

#### ğŸŒˆ useEffectëŠ” ì»´í¬ë„ŒíŠ¸ì˜ ë¼ì´í”„ì‚¬ì´í´ê³¼ ë¹„ìŠ·í•˜ê²Œ ì‘ë™í•˜ì—¬, íŠ¹ì • ìƒíƒœë‚˜ propì˜ ë³€ê²½ì— ë°˜ì‘í•˜ì—¬ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³ , í•„ìš” ì‹œ ì •ë¦¬ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•¨. <br>

#### ì´ë¥¼í†µí•´ ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë  ë•Œë§ˆë‹¤ í•„ìš”í•œ ì‘ì—…ì„ ì‰½ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•¨
